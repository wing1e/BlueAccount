{"version":3,"file":"pie-chart.js","sources":["utils/chart/pie-chart.js"],"sourcesContent":["import {getNodeInfo} from \"../node-info.js\"\r\n\r\nexport const EXPENSE_TYPE = [\r\n  {\"category\": \"购物\", \"color\": \"#00B6E6\"},\r\n  {\"category\": \"餐饮\", \"color\": \"#FF6B6B\"},\r\n  {\"category\": \"交通\", \"color\": \"#4CAF50\"},\r\n  {\"category\": \"住房\", \"color\": \"#FFA726\"},\r\n  {\"category\": \"娱乐\", \"color\": \"#9C27B0\"},\r\n  {\"category\": \"医疗\", \"color\": \"#F44336\"},\r\n  {\"category\": \"教育\", \"color\": \"#2196F3\"},\r\n  {\"category\": \"投资\", \"color\": \"#FFD700\"},\r\n  {\"category\": \"工资\", \"color\": \"#4CAF50\"},\r\n  {\"category\": \"旅行\", \"color\": \"#E91E63\"},\r\n  {\"category\": \"礼物\", \"color\": \"#FF4081\"},\r\n  {\"category\": \"其他\", \"color\": \"#9E9E9E\"}\r\n]\r\n\r\nexport const INCOME_TYPE = [\r\n\t{\"category\": \"工资\", \"color\": \"#4CAF50\"},\r\n\t{\"category\": \"奖金\", \"color\": \"#9C27B0\"},\r\n\t{\"category\": \"兼职\", \"color\": \"#E91E63\"},\r\n\t{\"category\": \"理财\", \"color\": \"#FFC107\"},\r\n\t{\"category\": \"其他收入\", \"color\": \"#9E9E9E\"}\r\n]\r\n\r\nexport const pieCharInit = async (instance, chartData, className, canvasId) =>{\r\n\t\t\r\n\t\ttry {\r\n\t\t\tconst canvasNode =await getNodeInfo(instance,className)\r\n\t\t\tconst {height:ctxH,width:ctxW} = canvasNode[0]\r\n\t\t\tconst ctx = uni.createCanvasContext(canvasId,instance)\r\n\t\t\t\r\n\t\t\tconst centerX = ctxW/2 //圆形X坐标\r\n\t\t\tconst centerY = ctxH/2 //圆形Y坐标\r\n\t\t\tconst outerR = (ctxH-10)/2 //外圆半径 \r\n\t\t\tconst innerR = (ctxH-40)/2 //内圆半径\r\n\r\n\t\t\tconst expense = new Map(Object.entries(chartData.expense)); // 支出数据\r\n\t\t\t// const income = new Map(Object.entries(chartData.income)); // 收入数据\r\n\r\n\t\t\tlet startAngle = -Math.PI / 2; // 起始角度从12点方向开始\r\n\t\t\t\r\n\t\t\texpense.forEach((val,key)=> {\r\n\t\t\t\t\t\r\n\t\t\t        const sliceAngle = val/100 * 2 * Math.PI;\r\n\t\t\t        const endAngle = startAngle + sliceAngle;\r\n\t\t\t\r\n\t\t\t        // 绘制路径\r\n\t\t\t        ctx.beginPath();\r\n\t\t\t        // 外圆弧（顺时针）\r\n\t\t\t        ctx.arc(centerX, centerY, outerR, startAngle, endAngle, false);\r\n\t\t\t        // 内圆弧（逆时针返回，形成闭合环）\r\n\t\t\t        ctx.arc(centerX, centerY, innerR, endAngle, startAngle, true);\r\n\t\t\t        ctx.closePath();\t\r\n\t\t\t        // 设置填充颜色\r\n\t\t\t        ctx.setFillStyle(EXPENSE_TYPE.find(item=>item.category == key).color);\r\n\t\t\t        ctx.fill();\r\n\t\t\t\t\t\t\r\n\t\t\t        startAngle = endAngle; // 更新起始角度\r\n\t\t\t      });\r\n\t\t\t\r\n\t\t\t      // 执行绘制\r\n\t\t\t      ctx.draw();\r\n\t\t\t\r\n\t\t\t\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}"],"names":["getNodeInfo","uni"],"mappings":";;;AAEY,MAAC,eAAe;AAAA,EAC1B,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AACvC;AAEY,MAAC,cAAc;AAAA,EAC1B,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,MAAM,SAAS,UAAS;AAAA,EACrC,EAAC,YAAY,QAAQ,SAAS,UAAS;AACxC;AAEY,MAAC,cAAc,OAAO,UAAU,WAAW,WAAW,aAAY;AAE5E,MAAI;AACH,UAAM,aAAY,MAAMA,2BAAY,UAAS,SAAS;AACtD,UAAM,EAAC,QAAO,MAAK,OAAM,KAAI,IAAI,WAAW,CAAC;AAC7C,UAAM,MAAMC,cAAG,MAAC,oBAAoB,UAAS,QAAQ;AAErD,UAAM,UAAU,OAAK;AACrB,UAAM,UAAU,OAAK;AACrB,UAAM,UAAU,OAAK,MAAI;AACzB,UAAM,UAAU,OAAK,MAAI;AAEzB,UAAM,UAAU,IAAI,IAAI,OAAO,QAAQ,UAAU,OAAO,CAAC;AAGzD,QAAI,aAAa,CAAC,KAAK,KAAK;AAE5B,YAAQ,QAAQ,CAAC,KAAI,QAAO;AAEpB,YAAM,aAAa,MAAI,MAAM,IAAI,KAAK;AACtC,YAAM,WAAW,aAAa;AAG9B,UAAI,UAAS;AAEb,UAAI,IAAI,SAAS,SAAS,QAAQ,YAAY,UAAU,KAAK;AAE7D,UAAI,IAAI,SAAS,SAAS,QAAQ,UAAU,YAAY,IAAI;AAC5D,UAAI,UAAS;AAEb,UAAI,aAAa,aAAa,KAAK,UAAM,KAAK,YAAY,GAAG,EAAE,KAAK;AACpE,UAAI,KAAI;AAER,mBAAa;AAAA,IACxB,CAAU;AAGD,QAAI,KAAI;AAAA,EAGd,SAAQ,OAAO;AACfA,kBAAAA,MAAA,MAAA,OAAA,kCAAY,KAAK;AAAA,EACjB;AACH;;;;"}