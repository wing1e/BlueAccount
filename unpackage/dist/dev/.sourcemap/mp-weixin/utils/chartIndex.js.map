{"version":3,"file":"chartIndex.js","sources":["utils/chartIndex.js"],"sourcesContent":["import { getNodeInfo } from \"./getnodeinfo\"\n\n// 初始化图表\nexport const init =async (instance,chartData,className,canvasId)=>{\r\n\ttry {\r\n\t\t// 获取canvas的宽和高\r\n\t\tconst canvasNode = await getNodeInfo(instance,className)\r\n\t\t\r\n\t\tconst {width:ctxW,height:ctxH} = canvasNode[0]\r\n\t\t// 绘制图形\r\n\t\tconst ctx = uni.createCanvasContext(canvasId,instance)\r\n\t\tconst yMin= 100 //折线图上边缘\r\n\t\tconst yMax = ctxH - 15 //折线图下边缘\r\n\t\t\r\n\t\t// 上实线\r\n\t\t// ctx.beginPath()\r\n\t\t// ctx.strokeStyle = '#E3E3E5'\r\n\t\t// ctx.lineWidth = 1\r\n\t\t// ctx.moveTo(0,yMin)\r\n\t\t// ctx.lineTo(ctxW,yMin)\r\n\t\t\r\n\t\t// 下实线\r\n\t\tctx.moveTo(0,yMax)\r\n\t\tctx.lineTo(ctxW,yMax)\r\n\t\tctx.strokeStyle = '#E3E3E5'\r\n\t\tctx.stroke()\r\n\t\t\r\n\t\t// 中虚线\r\n\t\tctx.beginPath()\r\n\t\tctx.setLineDash([2,4]) //虚线样式 2px 的实线 3px 的空白\r\n\t\tctx.lineWidth = 1\r\n\t\tctx.moveTo(0,(yMax+yMin)/2)\r\n\t\tctx.lineTo(ctxW,(yMax+yMin)/2)\r\n\t\tctx.stroke()\r\n\t\t\r\n\t\t// 底部标题\r\n\t\tconst space = ctxW/8 //标题间隔大小\r\n\t\t// 生成日期配置\r\n\t\tconst data = [...new Set(chartData.map(item =>item.date.split(/[-]/)[1]+'-'+item.date.split(/[-]/)[2]))]\r\n\t\tconst weekStrings = data.map((date,i) => {\r\n\t\t\tconst textAlign = 'center'\r\n\t\t\treturn {\r\n\t\t\t\tdate,\r\n\t\t\t\ttextAlign,\r\n\t\t\t\tx:(i+1)*space\r\n\t\t\t}\r\n\t\t})\r\n\t\tctx.setFontSize(10)\r\n\t\t// 循环绘制日期标签\r\n\t\tweekStrings.forEach(({date,textAlign,x}) => {\r\n\t\t\tctx.setTextAlign(textAlign)\r\n\t\t\tctx.fillText(date, x, ctxH, space);\r\n\t\t})\r\n\t\t\r\n\t\t// 绘制坐标点\r\n\t\tconst maxY = Math.max(...chartData.map(item => item.expense)) //支出的最大值\r\n\t\tconst points = chartData.map((item,i) =>{\r\n\t\treturn {\r\n\t\t\t\tx:(i+1)*space,\r\n\t\t\t\ty:((yMax-yMin)*(1-item.expense/maxY)+yMin).toFixed(1),\r\n\t\t\t\texpense:item.expense\r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\t// 绘制线条\r\n\t\tctx.beginPath();\r\n\t\tctx.lineWidth = 0.5\r\n\t\tctx.moveTo(points[0].x, points[0].y);\r\n\t\tpoints.forEach(point => ctx.lineTo(point.x, point.y));\r\n\t\tctx.strokeStyle = '#909090'\r\n\t\tctx.setLineDash([1,0])\r\n\t\tctx.stroke();\r\n\t\t\r\n\t\t// 绘制圆点\r\n\t\tpoints.forEach(point => {\r\n\t\t  ctx.beginPath();\r\n\t\t  ctx.arc(point.x, point.y, 3, 0, Math.PI * 2);\r\n\t\t  ctx.fillStyle = '#00B6E6'\r\n\t\t  ctx.fill()\r\n\t\t  ctx.lineWidth = 0.5\r\n\t\t ctx.stroke();\r\n\t\t});\r\n\t\t\r\n\t\t// 绘制\r\n\t\tctx.draw();\r\n\t} catch (error) {\r\n\t\tconsole.log(error);\r\n\t}\n\t\n}"],"names":["getNodeInfo","uni"],"mappings":";;;AAGY,MAAC,OAAM,OAAO,UAAS,WAAU,WAAU,aAAW;AACjE,MAAI;AAEH,UAAM,aAAa,MAAMA,8BAAY,UAAS,SAAS;AAEvD,UAAM,EAAC,OAAM,MAAK,QAAO,KAAI,IAAI,WAAW,CAAC;AAE7C,UAAM,MAAMC,cAAG,MAAC,oBAAoB,UAAS,QAAQ;AACrD,UAAM,OAAM;AACZ,UAAM,OAAO,OAAO;AAUpB,QAAI,OAAO,GAAE,IAAI;AACjB,QAAI,OAAO,MAAK,IAAI;AACpB,QAAI,cAAc;AAClB,QAAI,OAAQ;AAGZ,QAAI,UAAW;AACf,QAAI,YAAY,CAAC,GAAE,CAAC,CAAC;AACrB,QAAI,YAAY;AAChB,QAAI,OAAO,IAAG,OAAK,QAAM,CAAC;AAC1B,QAAI,OAAO,OAAM,OAAK,QAAM,CAAC;AAC7B,QAAI,OAAQ;AAGZ,UAAM,QAAQ,OAAK;AAEnB,UAAM,OAAO,CAAC,GAAG,IAAI,IAAI,UAAU,IAAI,UAAO,KAAK,KAAK,MAAM,KAAK,EAAE,CAAC,IAAE,MAAI,KAAK,KAAK,MAAM,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;AACvG,UAAM,cAAc,KAAK,IAAI,CAAC,MAAK,MAAM;AACxC,YAAM,YAAY;AAClB,aAAO;AAAA,QACN;AAAA,QACA;AAAA,QACA,IAAG,IAAE,KAAG;AAAA,MACR;AAAA,IACJ,CAAG;AACD,QAAI,YAAY,EAAE;AAElB,gBAAY,QAAQ,CAAC,EAAC,MAAK,WAAU,EAAC,MAAM;AAC3C,UAAI,aAAa,SAAS;AAC1B,UAAI,SAAS,MAAM,GAAG,MAAM,KAAK;AAAA,IACpC,CAAG;AAGD,UAAM,OAAO,KAAK,IAAI,GAAG,UAAU,IAAI,UAAQ,KAAK,OAAO,CAAC;AAC5D,UAAM,SAAS,UAAU,IAAI,CAAC,MAAK,MAAK;AACxC,aAAO;AAAA,QACL,IAAG,IAAE,KAAG;AAAA,QACR,KAAI,OAAK,SAAO,IAAE,KAAK,UAAQ,QAAM,MAAM,QAAQ,CAAC;AAAA,QACpD,SAAQ,KAAK;AAAA,MACb;AAAA,IACJ,CAAG;AAGD,QAAI,UAAS;AACb,QAAI,YAAY;AAChB,QAAI,OAAO,OAAO,CAAC,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;AACnC,WAAO,QAAQ,WAAS,IAAI,OAAO,MAAM,GAAG,MAAM,CAAC,CAAC;AACpD,QAAI,cAAc;AAClB,QAAI,YAAY,CAAC,GAAE,CAAC,CAAC;AACrB,QAAI,OAAM;AAGV,WAAO,QAAQ,WAAS;AACtB,UAAI,UAAS;AACb,UAAI,IAAI,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,KAAK,KAAK,CAAC;AAC3C,UAAI,YAAY;AAChB,UAAI,KAAM;AACV,UAAI,YAAY;AACjB,UAAI,OAAM;AAAA,IACb,CAAG;AAGD,QAAI,KAAI;AAAA,EACR,SAAQ,OAAO;AACfA,kBAAAA,gDAAY,KAAK;AAAA,EACjB;AAEF;;"}